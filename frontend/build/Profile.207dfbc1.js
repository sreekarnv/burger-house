function e(e,a,r,t){Object.defineProperty(e,a,{get:r,set:t,enumerable:!0,configurable:!0})}var a=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequireb892;a.register("3NQ1f",(function(r,t){var s;s=r.exports,Object.defineProperty(s,"__esModule",{value:!0,configurable:!0}),e(r.exports,"default",(function(){return x}));var o=a("2fYNA"),n=a("8d0rP"),i=a("gsKHE"),l=a("bzs65"),d=a("jFA1T"),u=a("dMnY7"),p=a("hyaDb"),c=a("iuWU8"),f=a("wMVjP"),m=a("4x6ZE"),g=a("gXjMT"),h=a("jlZ8J"),w=a("joc9b"),j=a("B7eId");const y=i.object().shape({name:i.string().required("user must have a name"),email:i.string().required("user must have an email address").email("please enter a valid email")}),b=i.object().shape({currentPassword:i.string().required("please provide your current password"),password:i.string().required("user must provide a password").min(6,"password must contain atleast 6 characters"),passwordConfirm:i.string().required("users must confirm their password").when("password",{is:e=>!!(e&&e.length>0),then:i.string().oneOf([i.ref("password")],"passwords do not match")})});var x=()=>{const e=d.useQueryClient(),{alertMessage:a,alertType:r,setAlert:t,showAlert:s}=f.default(),{error:i,imagefile:x,imageUrl:v,uploadFile:P}=g.default(),S=j.useHistory(),U=e.getQueryData("user"),C=n.useRef(),{isLoading:N,updateDetails:_}=h.default({onSuccess:()=>{t("success","your details have been updated!")},onError:()=>{t("danger","could not update yout details")}}),{isLoading:F,updatePassword:T}=w.default({onSuccess:()=>{t("success","your password has been updated! You will be logged out")},onError:e=>{t("danger","could not update yout details")},onSettled:(e,a)=>{e&&setTimeout((()=>{S.replace("/auth/logout")}),1500)}});return n.useEffect((()=>{i&&t("danger",i)}),[i]),o.jsxs(o.Fragment,{children:[s&&o.jsx(m.default,{position:"top-center",type:r,children:a}),o.jsxs("div",{className:"profile",children:[o.jsx(l.Formik,{validationSchema:y,initialValues:{name:null==U?void 0:U.name,email:null==U?void 0:U.email},onSubmit:({name:e,email:a})=>{const r=new FormData;r.append("name",e),r.append("email",a),x&&r.append("photo",x),_(r)},children:o.jsxs(l.Form,{autoComplete:"off",className:"profile__form profile__form--1",children:[o.jsx("h2",{className:"heading-2 u-text-primary u-ftwt-400 u-mb-5",children:"Update User Details"}),o.jsx(p.default,{label:"Name",name:"name"}),o.jsx(p.default,{label:"Email",name:"email"}),o.jsxs("div",{className:"u-mb-5 profile__form-photo",children:[o.jsx(u.default,{type:"button",onClick:()=>{C.current.click()},variant:"outlined",size:"sm",children:"Upload Photo"}),o.jsx("input",{onChange:P,type:"file",style:{display:"none"},ref:C}),o.jsx(c.default,{src:v||""+(null==U?void 0:U.photoUrl),alt:null==U?void 0:U.name,size:"sm"})]}),o.jsx(u.default,{type:"submit",color:"tertiary",children:N?"Loading...":"Update Details"})]})}),o.jsx(l.Formik,{initialValues:{currentPassword:"",password:"",passwordConfirm:""},validationSchema:b,onSubmit:e=>{T(e)},children:()=>o.jsxs(l.Form,{autoComplete:"off",className:"profile__form profile__form--2",children:[o.jsx("h2",{className:"heading-2 u-text-primary u-mb-8 u-ftwt-400",children:"Update User Password"}),o.jsx(p.default,{label:"Current Password",name:"currentPassword",type:"password"}),o.jsx(p.default,{label:"Password",name:"password",type:"password"}),o.jsx(p.default,{label:"Password Confirm",name:"passwordConfirm",type:"password"}),o.jsx(u.default,{color:"tertiary",children:F?"Loading...":"Update Password"})]})})]})]})}})),a.register("gXjMT",(function(r,t){e(r.exports,"default",(function(){return n}));var s=a("8d0rP");const o=["webp","jpeg","jpg","png","svg+xml"];var n=()=>{const[e,a]=s.useState(),[r,t]=s.useState(),[n,i]=s.useState();return{error:e,imagefile:r,imageUrl:n,uploadFile:e=>{if(a(null),!e.target.files[0])return a("please upload an image");if(!o.includes(e.target.files[0].type.split("/")[1]))return a("please upload images only");t(e.target.files[0]);const r=URL.createObjectURL(e.target.files[0]);i(r)}}}})),a.register("jlZ8J",(function(r,t){e(r.exports,"default",(function(){return n}));var s=a("jFA1T"),o=a("fYxNN");var n=({onError:e,onSettled:a,onSuccess:r})=>{const t=s.useQueryClient(),{mutate:n,isLoading:i,data:l,error:d}=s.useMutation((e=>(async e=>(await o.default({method:"PATCH",url:"/api/v2/users/me",data:e})).data.data)(e)),{onSuccess:e=>{t.setQueryData("user",e),r&&r(e)},onError:a=>{e&&e(a)},onSettled:(e,r)=>{a&&a(e,r)}});return{updateDetails:n,data:l,isLoading:i,error:d}}})),a.register("joc9b",(function(r,t){e(r.exports,"default",(function(){return n}));var s=a("fYxNN"),o=a("jFA1T");var n=({onError:e,onSettled:a,onSuccess:r})=>{const{mutate:t,isLoading:n,data:i,error:l}=o.useMutation((e=>(async e=>(await s.default({method:"POST",url:"/api/v2/users/updateCurrentUserPassword",data:e})).data.user)(e)),{onSuccess:e=>{r&&r(e)},onError:a=>{e&&e(a)},onSettled:(e,r)=>{a&&a(e,r)}});return{updatePassword:t,data:i,isLoading:n,error:l}}}));