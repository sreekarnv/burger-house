(this["webpackJsonpburger-house-frontend"]=this["webpackJsonpburger-house-frontend"]||[]).push([[3],{115:function(t,e,r){"use strict";r.r(e);var n=r(23),a=r(1),c=r(0),s=r.n(c),o=r(5),i=r(7),u=r(90),d=r(18),l=r(82),p=r(91),f=r(87),b=r(86),m=r(6),h=r.n(m),v=r(8),j=r(10),O=r(93),g=r(94),x=r(97),y=r(96),k=r(15),_=r.n(k),w=r(95),N=r.n(w),C=function(t){Object(x.a)(r,t);var e=Object(y.a)(r);function r(){var t;Object(O.a)(this,r);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).getData=Object(j.a)(h.a.mark((function e(){var r,n,a,c,s,o,i,u,d,l,p,f,b,m,j,O,g,x;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new Date(t.props.order.createdAt),a=new Date(Date.now()),c=[78.267961,17.4126274],s=new N.a.Map({container:t.mapContainer,style:"mapbox://styles/sreekarnv/ckg0ssj7j2ia919oflok173f1",center:c,zoom:11,scrollZoom:!1}),t.map=s,o=t.res,"cancelled"===t.props.order.status?r=0:"delivered"===t.props.order.status?r=o.data.routes[0].geometry.coordinates.length-1:(i=n.getDate(),u=n.getMonth(),d=n.getFullYear(),l=a.getDate(),p=a.getMonth(),f=a.getFullYear(),i===l&&u===p&&d===f?(b=parseInt(a.getHours().toString(),10),m=parseInt(a.getMinutes().toString(),10),j=parseInt(n.getHours().toString(),10),O=parseInt(n.getMinutes().toString(),10),b===j?r=m-O:b>j&&(r=60*b+m-(60*j+O))):t.props.onChangeStatusHandler(),r>o.data.routes[0].geometry.coordinates.length&&(r=o.data.routes[0].geometry.coordinates.length-1,t.props.onChangeStatusHandler())),(new N.a.Marker).setLngLat(t.props.user.location.coordinates).addTo(s),(new N.a.Marker).setLngLat([78.267961,17.4126274]).addTo(s),new N.a.Popup({offset:30}).setLngLat([78.267961,17.4126274]).setHTML("<p>Burger House</p>").addTo(s),new N.a.Popup({offset:30}).setLngLat(t.props.user.location.coordinates).setHTML("<p>Your Location</p>").addTo(s),g={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:[t.props.user.location.coordinates,o.data.routes[0].geometry.coordinates[0]]}}]},t.route=g,x={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t.props.user.location.coordinates}}]},t.point=x,s.on("load",(function(){s.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:Object(v.a)(o.data.routes[0].geometry.coordinates)}}}),s.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#0099CC","line-width":8}}),s.addSource("route1",{type:"geojson",data:g}),s.addSource("point",{type:"geojson",data:x}),s.addLayer({id:"route1",source:"route",type:"line",paint:{"line-width":2,"line-color":"transparent"}}),s.addLayer({id:"point",source:"point",type:"symbol",layout:{"icon-image":"car-15","icon-size":2,"icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!0}}),x.features[0].geometry.coordinates=Object(v.a)(o.data.routes[0].geometry.coordinates).reverse()[r],s.getSource("point").setData(x)}));case 16:case"end":return e.stop()}}),e)}))),t}return Object(g.a)(r,[{key:"componentDidMount",value:function(){var t=Object(j.a)(h.a.mark((function t(){var e,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="pk.eyJ1Ijoic3JlZWthcm52IiwiYSI6ImNrY2Vsem4xZzA3MmYycG53NDR6eWJidWUifQ.tnWqUEjgrrsKkfuhDzOBJQ",N.a.accessToken=e,t.next=4,_()({method:"GET",url:"https://api.mapbox.com/directions/v5/mapbox/driving/".concat(this.props.user.location.coordinates[0],",").concat(this.props.user.location.coordinates[1],";78.267961,17.4126274?geometries=geojson&access_token=").concat(e)});case 4:r=t.sent,this.res=r,this.getData();case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.map.remove()}},{key:"render",value:function(){var t=this;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"mapContainer__heading",children:[Object(a.jsx)("h2",{className:"heading-2 u-text-primary u-ftwt-400",children:"Track Order"}),Object(a.jsx)("button",{className:"btn btn__tertiary btn__sm",onClick:this.getData,children:"Click Here To Update Map"})]}),Object(a.jsx)("div",{className:"mapContainer",style:{width:"100%",height:"100%"},ref:function(e){return t.mapContainer=e}})]})}}]),r}(s.a.Component),S=Object(o.b)((function(t){return{user:t.auth.user}}))(C),T=function(t){var e=t.showMap,r=t.setShowMap,n=t.order,c=Object(o.c)();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(b.a,{show:e,closeHandler:function(){return r(!1)}}),Object(a.jsx)("div",{className:"track-order ".concat(e?"track-order--show":"track-order--hide"),children:e&&Object(a.jsx)(S,{order:n,onChangeStatusHandler:function(){var t="pending";"pending"===n.status&&(t="delivered"),c(l.d(n._id,t))}})})]})};e.default=function(t){var e=t.admin,r=Object(o.c)(),s=Object(o.d)((function(t){return t.user.userOrder})),b=Object(o.d)((function(t){return t.user.userOrderInit})),m=Object(i.h)(),h=Object(o.d)((function(t){return t.auth.user})),v=Object(i.g)(),j=Object(c.useState)(!1),O=Object(n.a)(j,2),g=O[0],x=O[1];Object(c.useEffect)((function(){r(p.b()),r(l.a(m.id))}),[r,m]);return b?Object(a.jsx)(d.a,{fullScreen:!0}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(T,{order:s,showMap:g,setShowMap:x}),Object(a.jsxs)("div",{className:"order-detail-page",children:[Object(a.jsx)("button",{type:"button",onClick:function(){return v.goBack()},className:"btn btn__back u-text-tertiary order-detail-page__btn",children:"Go Back"}),Object(a.jsx)("div",{className:"order-detail-page__list",children:s&&s.items.map((function(t){return Object(a.jsx)(u.a,{hidebtn:!0,burger:t},t._id)}))}),Object(a.jsxs)("div",{className:"order-stats",children:[e&&Object(a.jsxs)("div",{className:"order-stats-item",children:[Object(a.jsx)("span",{className:"order-stats-item__field",children:"Customer: "}),Object(a.jsx)("span",{className:"order-stats-item__value u-text-capitalize",children:h.name})]}),Object(a.jsxs)("div",{className:"order-stats-item",children:[Object(a.jsx)("span",{className:"order-stats-item__field",children:"Ordered On:"}),Object(a.jsx)("span",{className:"order-stats-item__value",children:s&&"".concat(s.createdAt).split("T")[0]})]}),Object(a.jsxs)("div",{className:"order-stats-item",children:[Object(a.jsx)("span",{className:"order-stats-item__field",children:"Total Price:"}),Object(a.jsxs)("span",{className:"order-stats-item__value",children:["Rs ",s&&s.price]})]}),Object(a.jsxs)("div",{className:"order-stats-item",children:[Object(a.jsx)("span",{className:"order-stats-item__field",children:"Order Status: "}),Object(a.jsx)("span",{className:"order-stats-item__value u-text-uppercase \n\t\t\t\t\t".concat(s&&"pending"===s.status&&"u-text-danger","\n\t\t\t\t\t").concat(s&&"delivered"===s.status&&"u-text-success","\n\t\t\t\t\t").concat(s&&"cancelled"===s.status&&"u-text-dark","\n\t\t\t\t"),children:s&&s.status})]})]}),Object(a.jsxs)("div",{className:"order-detail-page__cta",children:[!e&&Object(a.jsx)("button",{onClick:function(){r(l.d(m.id))},disabled:!s||"pending"!==s.status,type:"button",className:"btn btn__danger--outline \n\t\t\t\t\t".concat(("cancelled"===(s&&s.status)||"delivered"===(s&&s.status))&&"btn__disabled--outline","\n\t\t\t\t\t"),children:"Cancel Order"}),!e&&Object(a.jsx)("button",{onClick:function(){return x(!0)},type:"button",className:"btn btn__tertiary--outline\n\t\t\t\t \t".concat((s&&"cancelled"===s.status||s&&"delivered"===s.status)&&"btn__disabled--outline","\n\t\t\t\t "),children:"Track Order"}),e&&Object(a.jsx)("button",{onClick:function(){r(f.e(m.id,{status:"delivered"}))},disabled:!s||"pending"!==s.status,type:"button",className:"btn btn__success--outline \n\t\t\t\t\t".concat(("cancelled"===(s&&s.status)||"delivered"===(s&&s.status))&&"btn__disabled--outline","\n\t\t\t\t\t"),children:"Mark As Delivered"}),e&&Object(a.jsx)("button",{onClick:function(){r(f.e(m.id,{status:"pending"}))},type:"button",disabled:!s||"delivered"!==s.status,className:"btn btn__danger--outline\n\t\t\t\t \t".concat((s&&"cancelled"===s.status||s&&"pending"===s.status)&&"btn__disabled--outline","\n\t\t\t\t "),children:"Mark As Pending"})]})]})]})}},82:function(t,e,r){"use strict";r.d(e,"c",(function(){return d})),r.d(e,"b",(function(){return l})),r.d(e,"a",(function(){return p})),r.d(e,"f",(function(){return f})),r.d(e,"g",(function(){return b})),r.d(e,"e",(function(){return m})),r.d(e,"d",(function(){return h}));var n=r(6),a=r.n(n),c=r(10),s=r(15),o=r.n(s),i=r(35),u=r(3),d=function(t){return function(){var e=Object(c.a)(a.a.mark((function e(r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:u.cb}),e.prev=1,e.next=4,o()({method:"PATCH",url:"/api/v2/users/me",data:t});case 4:n=e.sent,r({type:u.db}),r(Object(i.c)(n.data.data)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),r((a=e.t0.response.data,{type:u.bb,error:a}));case 12:case"end":return e.stop()}var a}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},l=function(){return function(){var t=Object(c.a)(a.a.mark((function t(e){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e({type:u.z}),t.prev=1,t.next=4,o()({method:"GET",url:"/api/v2/users/me/orders"});case 4:r=t.sent,e((a=r.data.data,{type:u.A,orders:a})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e((n=t.t0.response.data,{type:u.y,error:n}));case 11:case"end":return t.stop()}var n,a}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},p=function(t){return function(){var e=Object(c.a)(a.a.mark((function e(r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:u.C}),e.prev=1,e.next=4,o()({method:"GET",url:"/api/v2/users/me/orders/".concat(t)});case 4:n=e.sent,r((c=n.data.data,{type:u.D,order:c})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r((a=e.t0.response.data,{type:u.B,error:a}));case 11:case"end":return e.stop()}var a,c}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},f=function(){return{type:u.fb}},b=function(t){return{type:u.gb,order:t}},m=function(t){return{type:u.eb,error:t}},h=function(t,e){return function(){var r=Object(c.a)(a.a.mark((function r(n){var c;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n(f()),r.prev=1,r.next=4,o()({method:"PATCH",url:"/api/v2/users/me/orders/".concat(t),data:{status:e||"cancelled"}});case 4:c=r.sent,n(b(c.data.data)),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),n(m(r.t0.response.data));case 11:case"end":return r.stop()}}),r,null,[[1,8]])})));return function(t){return r.apply(this,arguments)}}()}},83:function(t,e,r){"use strict";var n=r(1);r(0);e.a=function(t){return Object(n.jsx)("div",{onClick:t.onClick,className:"base-list-item ".concat(t.className),children:t.children})}},86:function(t,e,r){"use strict";var n=r(1);r(0);e.a=function(t){var e=t.show,r=t.closeHandler;return Object(n.jsx)("div",{onClick:r,className:"backdrop ".concat(e&&"backdrop--show")})}},87:function(t,e,r){"use strict";r.d(e,"b",(function(){return l})),r.d(e,"c",(function(){return p})),r.d(e,"e",(function(){return f})),r.d(e,"d",(function(){return m})),r.d(e,"f",(function(){return h})),r.d(e,"a",(function(){return v}));var n=r(6),a=r.n(n),c=r(2),s=r(10),o=r(3),i=r(82),u=r(15),d=r.n(u),l=function(t){return function(){var e=Object(s.a)(a.a.mark((function e(r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:o.k}),e.prev=1,e.next=4,d()({method:"GET",url:"/api/v2/orders/admin",params:Object(c.a)({},t)});case 4:n=e.sent,r((s=n.data.data,{type:o.o,orders:s})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r((a=e.t0.response.data,{type:o.j,error:a}));case 11:case"end":return e.stop()}var a,s}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},p=function(t){return function(){var t=Object(s.a)(a.a.mark((function t(e){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e({type:o.m}),t.prev=1,t.next=4,d()({method:"GET",url:"/api/v2/orders/admin/orderStats"});case 4:r=t.sent,e((a=r.data.orderStats,{type:o.n,orderStats:a})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e((n=t.t0.response.data,{type:o.l,error:n}));case 11:case"end":return t.stop()}var n,a}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},f=function(t,e){return function(){var r=Object(s.a)(a.a.mark((function r(n){var c;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n(Object(i.f)()),r.prev=1,r.next=4,d()({method:"PATCH",url:"/api/v2/orders/admin/".concat(t),data:e});case 4:c=r.sent,n(Object(i.g)(c.data.data)),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),n(Object(i.e)(r.t0.response.data));case 11:case"end":return r.stop()}}),r,null,[[1,8]])})));return function(t){return r.apply(this,arguments)}}()},b=function(t){return{type:o.p,error:t}},m=function(){return function(){var t=Object(s.a)(a.a.mark((function t(e){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e({type:o.q}),t.prev=1,t.next=4,d()({method:"GET",url:"/api/v2/users"});case 4:r=t.sent,e((n=r.data.data,{type:o.r,users:n})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e(b(t.t0.response.data));case 11:case"end":return t.stop()}var n}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},h=function(t,e){return function(){var r=Object(s.a)(a.a.mark((function r(n){return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,d()({method:"PATCH",url:"/api/v2/users/".concat(t),data:e});case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),n(b(r.t0.response.data));case 8:case"end":return r.stop()}}),r,null,[[0,5]])})));return function(t){return r.apply(this,arguments)}}()},v=function(t){return function(){var e=Object(s.a)(a.a.mark((function e(r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d()({method:"DELETE",url:"/api/v2/users/".concat(t)});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),r(b(e.t0.response.data));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()}},88:function(t,e,r){"use strict";var n=r(2),a=r(1),c=r(0);function s(){return(s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function o(t,e){if(null==t)return{};var r,n,a=function(t,e){if(null==t)return{};var r,n,a={},c=Object.keys(t);for(n=0;n<c.length;n++)r=c[n],e.indexOf(r)>=0||(a[r]=t[r]);return a}(t,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(n=0;n<c.length;n++)r=c[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}var i=c.createElement("path",{d:"M3.389 7.113l1.101 10.908c0.061 0.461 2.287 1.977 5.51 1.979 3.225-0.002 5.451-1.518 5.511-1.979l1.102-10.908c-1.684 0.942-4.201 1.387-6.613 1.387-2.41 0-4.928-0.445-6.611-1.387zM13.168 1.51l-0.859-0.951c-0.332-0.473-0.692-0.559-1.393-0.559h-1.831c-0.7 0-1.061 0.086-1.392 0.559l-0.859 0.951c-2.57 0.449-4.434 1.64-4.434 2.519v0.17c0 1.547 3.403 2.801 7.6 2.801 4.198 0 7.601-1.254 7.601-2.801v-0.17c0-0.879-1.863-2.070-4.433-2.519zM12.070 4.34l-1.070-1.34h-2l-1.068 1.34h-1.7c0 0 1.862-2.221 2.111-2.522 0.19-0.23 0.384-0.318 0.636-0.318h2.043c0.253 0 0.447 0.088 0.637 0.318 0.248 0.301 2.111 2.522 2.111 2.522h-1.7z"});function u(t,e){var r=t.title,n=t.titleId,a=o(t,["title","titleId"]);return c.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",ref:e,"aria-labelledby":n},a),void 0===r?c.createElement("title",{id:n},"trash"):r?c.createElement("title",{id:n},r):null,i)}var d=c.forwardRef(u);r.p,e.a=function(t){return Object(a.jsx)(d,Object(n.a)({},t))}},90:function(t,e,r){"use strict";var n=r(1),a=(r(0),r(28)),c=r(38),s=r(88),o=r(83),i=r(40);e.a=function(t){var e=t.burger,r=t.addBurger,u=t.removeBurger,d=t.removeAll,l=t.hidebtn;return Object(n.jsxs)(o.a,{className:"cart__list-item ".concat(l&&"cart__list-item-sm"),children:[Object(n.jsxs)("div",{className:"cart__list-item-image",children:[e.photoUrl&&Object(n.jsx)("img",{src:e.photoUrl,alt:"item"}),!e.photoUrl&&Object(n.jsx)(i.a,{})]}),Object(n.jsxs)("h4",{className:"cart__list-item-name",children:[e.name," (",e.itemsInCart,")"]}),Object(n.jsxs)("p",{className:"cart__list-item-price",children:[!l&&"Rs ".concat(e.price*e.itemsInCart),l&&"Rs ".concat(e.price," ")]}),!l&&Object(n.jsx)(c.a,{addItem:function(){return r(e)},removeItem:function(){return u(e)},children:e.itemsInCart}),!l&&Object(n.jsx)(a.a,{onClick:function(){return d(e)},className:"cart__list-item-delete-btn",children:Object(n.jsx)(s.a,{className:"u-fill-danger-60"})}),e.name.startsWith("Custom")&&e.ingredients.map((function(t){return t.items>0?Object(n.jsxs)("p",{className:"cart__list-item-ings",children:[t.name," X ",t.items]},t.name):null}))]})}},91:function(t,e,r){"use strict";r.d(e,"a",(function(){return u})),r.d(e,"b",(function(){return d}));var n=r(6),a=r.n(n),c=r(10),s=r(15),o=r.n(s),i=r(3),u=function(t){return function(){var e=Object(c.a)(a.a.mark((function e(r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:i.M}),e.prev=1,e.next=4,o()({method:"POST",url:"/api/v2/orders",data:t});case 4:n=e.sent,r((c=n.data.data,{type:i.N,newOrder:c})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r((a=void 0,{type:i.L,error:a}));case 11:case"end":return e.stop()}var a,c}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},d=function(){return{type:i.V}}}}]);
//# sourceMappingURL=3.1b589413.chunk.js.map