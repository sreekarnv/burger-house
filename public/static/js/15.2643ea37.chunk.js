(this["webpackJsonpburger-house"]=this["webpackJsonpburger-house"]||[]).push([[15],{117:function(e,t,r){"use strict";r.r(t);var a=r(5),n=r.n(a),s=r(0),o=r(11),d=r(14),c=r(15),u=r(17),i=r(16),l=r(1),p=r.n(l),m=r(12),h=r(86),f=r(89),b=r(80),O=r(20),v=function(e){Object(u.a)(r,e);var t=Object(i.a)(r);function r(){var e;Object(d.a)(this,r);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).state={orders:null},e.onChangeStatusHandler=Object(o.a)(n.a.mark((function t(){var r;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="pending","pending"===e.state.orders.status&&(r="delivered"),t.next=4,e.props.updateOrderStatusAdmin({status:r,_id:e.props.match.params.id});case 4:"success"===e.props.orderStatus&&e.setState({orders:Object(s.a)(Object(s.a)({},e.state.orders),{},{status:e.props.updatedOrder.status})});case 5:case"end":return t.stop()}}),t)}))),e.onCancelOrder=Object(o.a)(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.updateOrderStatusAdmin({status:"cancelled",_id:e.props.match.params.id});case 2:"success"===e.props.orderStatus&&e.setState({orders:Object(s.a)(Object(s.a)({},e.state.orders),{},{status:e.props.updatedOrder.status})});case 3:case"end":return t.stop()}}),t)}))),e}return Object(c.a)(r,[{key:"componentDidMount",value:function(){var e=Object(o.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.getOrder(this.props.match.params.id);case 2:if(this.props.order||!this.props.match.url.startsWith("/dashboard/manage-orders")){e.next=6;break}return e.abrupt("return",this.props.history.push("/dashboard/manage-orders"));case 6:if(this.props.order||!this.props.match.url.startsWith("/dashboard/my-orders")){e.next=10;break}return e.abrupt("return",this.props.history.push("/dashboard/my-orders"));case 10:t=this.props.order,this.setState({orders:t});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=0;return this.state.orders&&this.state.orders.orders.map((function(e){return t+=e.items})),this.state.isLoading||!this.state.orders?p.a.createElement("div",{className:"dashboard__dashboard u-flex-center u-bg-white u-vh-100"},p.a.createElement(O.a,null)):p.a.createElement("div",{className:"order__details dashboard__dashboard"},p.a.createElement("button",{onClick:function(){return e.props.history.push(e.props.match.url.startsWith("/dashboard/my-orders")?"/dashboard/my-orders":"/dashboard/manage-orders")},className:"btn  btn__tertiary-back order__details-back-btn"},p.a.createElement("span",null,"\u2190"),"Back"),p.a.createElement("h4",{className:"heading-1 order__details-heading"},"Order Details"),p.a.createElement("div",{className:"order__details-info"},p.a.createElement("div",null,p.a.createElement("h2",null,"Order Id: #",this.props.match.params.id),p.a.createElement("h4",null,this.state.orders.user.name),p.a.createElement("p",null,this.state.orders.user.email)),p.a.createElement("div",{className:"order__details-info-status order__details-info-status--total-orders"},p.a.createElement(f.a,{className:"order__details-info-status-card",heading:"Order Status",value:this.state.orders.status}),"admin"===this.props.loggedInUser.role&&this.props.match.url.startsWith("/dashboard/manage-orders/")&&p.a.createElement("button",{onClick:this.onChangeStatusHandler,disabled:"cancelled"===this.state.orders.status,className:"btn btn__success--outline".concat("cancelled"===this.state.orders.status?"-disabled":""," ")},"Mark Order as ","pending"===this.state.orders.status?"Delivered":"Pending"),"/dashboard/my-orders/:id"===this.props.match.path&&p.a.createElement("button",{onClick:this.onCancelOrder,className:"btn btn__success--outline".concat("delivered"===this.state.orders.status||"cancelled"===this.state.orders.status?"-disabled":""," ")},"Cancel Order")),p.a.createElement(f.a,{className:"order__details-info-status-card",heading:"Total Orders",value:t})),p.a.createElement("div",{className:"order__details-list"},this.state.orders.orders.map((function(e){return p.a.createElement(h.a,{className:"order__details-list-item u-bg-".concat(e._id.foodType,"--opacity-35")},p.a.createElement(p.a.Fragment,null,p.a.createElement("p",{className:"order__details-list-item-name"},e._id.title," (",e.items,")"),p.a.createElement("div",{className:"order__details-list-item-ings"},e._id.ingredients.map((function(e){return p.a.createElement("p",null,e._id.name?e._id.name:e.name," (",e.amount,")")})))))}))))}}]),r}(l.Component);t.default=Object(m.b)((function(e){return{orders:e.orders.orders,getOrderInit:e.orders.getOrderInit,order:e.orders.order,loggedInUser:e.auth.user,orderStatus:e.orders.updateOrderStatusAdminStatus.status,updatedOrder:e.orders.updateOrderStatusAdminStatus.order}}),(function(e){return{getOrder:function(t){return e(b.e(t))},updateOrderStatusAdmin:function(t){return e(b.f(t))}}}))(v)},77:function(e,t,r){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function n(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(t,"a",(function(){return n}))},80:function(e,t,r){"use strict";r.d(t,"d",(function(){return p})),r.d(t,"b",(function(){return h})),r.d(t,"a",(function(){return f})),r.d(t,"c",(function(){return v})),r.d(t,"f",(function(){return _})),r.d(t,"e",(function(){return j}));var a=r(5),n=r.n(a),s=r(77),o=r(0),d=r(11),c=r(2),u=r(18),i=r.n(u),l=function(e){return{type:c.O,error:e}},p=function(){return function(){var e=Object(d.a)(n.a.mark((function e(t){var r,a,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:c.P}),e.prev=1,e.next=4,i.a.get("/api/v1/orders/me");case 4:r=e.sent,a=Object.keys(r.data.orders).map((function(e){return Object(o.a)(Object(o.a)({},r.data.orders[e]),{},{orders:[].concat(Object(s.a)(r.data.orders[e].customOrders),Object(s.a)(r.data.orders[e].menuOrders)),customOrders:null,menuOrders:null})})),t((n=a,{type:c.Q,orders:n})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),d=Object(o.a)({},e.t0).response,t(l(d));case 13:case"end":return e.stop()}var n}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},m=function(e){return{type:c.o,error:e}},h=function(e){return function(){var t=Object(d.a)(n.a.mark((function t(r){var a,s;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r({type:c.p}),t.prev=1,t.next=4,i()({method:"POST",url:"/api/v1/orders",data:e});case 4:a=t.sent,r((n=a.data.orders,{type:c.q,orders:n})),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),s=Object(o.a)({},t.t0).response,r(m(s));case 12:case"end":return t.stop()}var n}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},f=function(){return{type:c.f}},b=function(e){var t=e.order,r=e.totalOrders,a=e.pendingOrders,n=e.completedOrders,s=e.totalPrice;return{type:c.K,orders:t,totalOrders:r,pendingOrders:a,completedOrders:n,totalPrice:s}},O=function(e){return{type:c.I,error:e}},v=function(e){return function(){var t=Object(d.a)(n.a.mark((function t(r){var a,d,u,l,p,m,h,f,v;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r({type:c.J}),t.prev=1,a=[],d="",t.next=6,i.a.get("/api/v1/orders");case 6:if(l=t.sent,"All Orders"===e){t.next=13;break}return d="?status=".concat(e),t.next=11,i.a.get("/api/v1/orders".concat(d));case 11:u=t.sent,Object.keys(u.data.orders).map((function(e){return a.push(Object(o.a)(Object(o.a)({},u.data.orders[e]),{},{orders:[].concat(Object(s.a)(l.data.orders[e].customOrders),Object(s.a)(l.data.orders[e].menuOrders)),customOrders:null,menuOrders:null})),a}));case 13:p=l.data.orders.length,m=0,h=0,f=0,Object.keys(l.data.orders).map((function(t){return"pending"===l.data.orders[t].status?h+=1:"delivered"===l.data.orders[t].status&&(f+=1),"cancelled"!==l.data.orders[t].status&&(m+=l.data.orders[t].price),"All Orders"===e?(a.push(Object(o.a)(Object(o.a)({},l.data.orders[t]),{},{orders:[].concat(Object(s.a)(l.data.orders[t].customOrders),Object(s.a)(l.data.orders[t].menuOrders)),customOrders:null,menuOrders:null})),a):""})),r(b({order:a,totalOrders:p,pendingOrders:h,completedOrders:f,totalPrice:m})),t.next=25;break;case 21:t.prev=21,t.t0=t.catch(1),v=Object(o.a)({},t.t0).response,r(O(v));case 25:case"end":return t.stop()}}),t,null,[[1,21]])})));return function(e){return t.apply(this,arguments)}}()},y=function(e){return{type:c.Eb,response:e}},_=function(e){var t=e.status,r=e._id;return function(){var e=Object(d.a)(n.a.mark((function e(a){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i()({url:"/api/v1/orders/".concat(r),method:"PATCH",data:{status:t}});case 3:s=e.sent,a(y(s.data)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),a(y(e.t0.response.data));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},g=function(e){return{type:c.Z,order:e}},j=function(e){return function(){var t=Object(d.a)(n.a.mark((function t(r){var a,d,u;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r({type:c.Y}),t.prev=1,t.next=4,i()({url:"/api/v1/orders/".concat(e),method:"get"});case 4:a=t.sent,u=[],a.data.order.customOrders.map((function(e){return u.push({_id:{ingredients:e.ingredients,title:e.name,foodType:e.foodType,_id:e._id,photo:e.photo,price:e.price},items:parseInt(e.items)}),u})),d=Object(o.a)(Object(o.a)({},a.data.order),{},{orders:[].concat(u,Object(s.a)(a.data.order.menuOrders)),customOrders:null,menuOrders:null}),r(g(d)),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),r((n=t.t0.response.data,{type:c.Z,error:n}));case 14:case"end":return t.stop()}var n}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}()}},86:function(e,t,r){"use strict";var a=r(1),n=r.n(a),s=r(24);t.a=function(e){return n.a.createElement(s.b,{to:e.to?e.to:"#",className:"list__item ".concat(e.className),style:{listStyle:"none"}},e.children)}},89:function(e,t,r){"use strict";var a=r(1),n=r.n(a);t.a=function(e){return n.a.createElement("div",{className:"card__status ".concat(e.className)},n.a.createElement("h2",null,e.heading),n.a.createElement("p",null,e.value))}}}]);
//# sourceMappingURL=15.2643ea37.chunk.js.map